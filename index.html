<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Triathlon Calc</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --bg: #0f1216;
      --panel: #171b21;
      --accent: #3a86ff;
      --text: #e9edf3;
      --muted: #9aa4b2;
    }
    * { box-sizing: border-box; }
    body { margin: 0; font-family: Inter, Arial, sans-serif; background: var(--bg); color: var(--text); }
    nav { background: var(--panel); border-bottom: 1px solid #222; display: flex; gap: 16px; padding: 12px 16px; position: sticky; top: 0; }
    nav a { color: var(--text); text-decoration: none; padding: 8px 10px; border-radius: 8px; }
    nav a.active { background: var(--accent); color: white; }
    main { max-width: 980px; margin: 24px auto; padding: 0 16px; }
    .tab { display: none; }
    .tab.active { display: block; }
    h2 { margin: 0 0 16px; font-size: 22px; }
    .card { background: var(--panel); border: 1px solid #222; border-radius: 12px; padding: 16px; }
    fieldset { border: 1px solid #2a2f37; border-radius: 10px; padding: 12px; margin: 0 0 12px; }
    legend { padding: 0 6px; color: var(--muted); font-size: 12px; }
    label { display: grid; grid-template-columns: 140px 1fr; align-items: center; gap: 12px; margin: 8px 0; }
    input[type="number"], input[type="text"] {
      width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #2a2f37;
      background: #12161b; color: var(--text); outline: none;
    }
    .activeBtn {
  background: #22c55e;
  color: white;
}
    input:focus { border-color: var(--accent); }
    .btn {
      display: inline-block; padding: 10px 14px; border-radius: 10px; border: 0;
      background: var(--accent); color: white; font-weight: 600; cursor: pointer;
    }
    .btn.secondary { background: #2c3340; color: var(--text); }
    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    .result { margin-top: 12px; padding: 12px; border-radius: 10px; background: #12161b; border: 1px solid #2a2f37; }
    .muted { color: var(--muted); font-size: 12px; }
    @media (max-width: 720px) {
      label { grid-template-columns: 1fr; gap: 6px; }
      .grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <nav>
    <a href="#" id="tab-run" class="active" onclick="showTab('run')">üèÉ –ë–µ–≥</a>
    <a href="#" id="tab-bike" onclick="showTab('bike')">üö¥ –í–µ–ª–æ—Å–∏–ø–µ–¥</a>
    <a href="#" id="tab-swim" onclick="showTab('swim')">üèä –ü–ª–∞–≤–∞–Ω–∏–µ</a>
  </nav>

  <main>
    <!-- –ë–µ–≥ -->
    <section id="run" class="tab active">
      <div class="card">
        <h2>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –¥–ª—è –±–µ–≥–∞ ‚Äî —Ç–µ–º–ø ‚Üî –¥–∏—Å—Ç–∞–Ω—Ü–∏—è ‚Üî –≤—Ä–µ–º—è</h2>

        <div class="grid">
          <fieldset>
            <legend>–î–∏—Å—Ç–∞–Ω—Ü–∏—è</legend>
            <label>
              <span>–ö–∏–ª–æ–º–µ—Ç—Ä—ã</span>
              <input type="number" id="runDistance" step="0.1" min="0">
            </label>
          </fieldset>

<fieldset>
  <legend>–¢–µ–º–ø (–º–∏–Ω/–∫–º)</legend>
  <label>
    <span>–§–æ—Ä–º–∞—Ç -:--</span>
    <div style="display:flex;align-items:center;gap:4px;">
      <input type="number" id="runPaceM" min="0" style="width:60px;">
      <span>:</span>
      <input type="number" id="runPaceS" min="0" max="59" style="width:60px;">
    </div>
  </label>
</fieldset>

        </div>

<fieldset>
  <legend>–í—Ä–µ–º—è</legend>
  <div style="display:flex;align-items:center;gap:4px;">
    <input type="number" id="runTimeH" min="0" style="width:60px;">
    <span>:</span>
    <input type="number" id="runTimeM" min="0" max="59" style="width:60px;">
    <span>:</span>
    <input type="number" id="runTimeS" min="0" max="59" style="width:60px;">
  </div>
</fieldset>

        <div style="display:flex; gap:8px; margin-top:8px;">
          <button class="btn" type="button" onclick="calcRun()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
          <button class="btn secondary" type="button" onclick="clearRun()">–°–±—Ä–æ—Å–∏—Ç—å</button>
        </div>

        <button id="intervalBtn" class="btn secondary" onclick="toggleIntervals()">–ò–Ω—Ç–µ—Ä–≤–∞–ª—ã</button>
        
               <div id="runResult" class="result"></div>
      </div>
    </section>

    <section id="intervalsBlock" class="tab" style="display:none; margin-top:16px;">
      <div class="card">
        <h3>–ò–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h3>
        <button class="btn" type="button" onclick="addInterval()">–î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª</button>
        <div id="intervalList"></div>
        <button class="btn" type="button" onclick="calcIntervals()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã</button>
        <div id="intervalResult" class="result"></div>
        <button class="btn secondary" type="button" onclick="clearAllIntervals()">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë</button>
        <button class="btn secondary" type="button" onclick="exitIntervals()">–ù–∞–∑–∞–¥ –∫ –±–µ–≥—É</button>
      </div>
    </section>

    <!-- –í–µ–ª–æ—Å–∏–ø–µ–¥ -->
    <section id="bike" class="tab">
      <div class="card">
        <h2>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –¥–ª—è –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞</h2>
        <p class="muted">–ó–¥–µ—Å—å –ø–æ–∑–∂–µ –¥–æ–±–∞–≤–∏–º —Å–∫–æ—Ä–æ—Å—Ç—å ‚Üî –¥–∏—Å—Ç–∞–Ω—Ü–∏—è ‚Üî –≤—Ä–µ–º—è –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã.</p>
      </div>
    </section>

    <!-- –ü–ª–∞–≤–∞–Ω–∏–µ -->
    <section id="swim" class="tab">
      <div class="card">
        <h2>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –¥–ª—è –ø–ª–∞–≤–∞–Ω–∏—è</h2>
        <p class="muted">–ó–¥–µ—Å—å –ø–æ–∑–∂–µ –¥–æ–±–∞–≤–∏–º —Ç–µ–º–ø (–º–∏–Ω/100 –º), –¥–ª–∏–Ω—É –±–∞—Å—Å–µ–π–Ω–∞ –∏ —Å–µ—Ä–∏–∏.</p>
      </div>
    </section>
  </main>

  <script>
    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
    function showTab(tabId) {
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.getElementById(tabId).classList.add('active');
      document.querySelectorAll('nav a').forEach(a => a.classList.remove('active'));
      document.getElementById('tab-' + tabId).classList.add('active');
    }

    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
    function toMinutes(h, m, s) {
      h = Number(h) || 0;
      m = Number(m) || 0;
      s = Number(s) || 0;
      return h * 60 + m + s / 60;
    }

let intervalMode = false;
let intervalCount = 0;

function toggleIntervals() {
  intervalMode = !intervalMode;
  const baseCalcCard = document.querySelector('#run .card'); // —Å–∫—Ä—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –∫–∞—Ä—Ç–æ—á–∫—É
  const intervals = document.getElementById('intervalsBlock');
  const list = document.getElementById('intervalList');
  if (intervalMode) {
    baseCalcCard.style.display = "none";
    intervals.style.display = "block";
    list.innerHTML = "";
    intervalCount = 0;
    addInterval();
    addInterval();
  } else {
    baseCalcCard.style.display = "block";
    intervals.style.display = "none";
  }
}

function exitIntervals() {
  intervalMode = false;
  const baseCalcCard = document.querySelector('#run .card');
  const intervals = document.getElementById('intervalsBlock');
  baseCalcCard.style.display = "block";
  intervals.style.display = "none";
}


function addInterval() {
  intervalCount++;
  const container = document.getElementById('intervalList');
  const block = document.createElement('div');
  block.className = "card";
  block.style.marginTop = "10px";
  block.innerHTML = `
    <h4>–ò–Ω—Ç–µ—Ä–≤–∞–ª</h4>
    <label>–î–∏—Å—Ç–∞–Ω—Ü–∏—è (–∫–º): <input type="number" step="0.1" min="0" class="intDistance"></label><br>
    <label>–¢–µ–º–ø (–º–∏–Ω/–∫–º): 
    <div style="display:flex;align-items:center;gap:4px;">
      <input type="number" min="0" class="intPaceM" style="width:60px;">
      <span>:</span>
      <input type="number" min="0" max="59" class="intPaceS" style="width:60px;">
    </div>
    </label><br>
    <label>–í—Ä–µ–º—è (—á:–º:—Å): 
  <div style="display:flex;align-items:center;gap:4px;">
    <input type="number" min="0" class="intTimeH" style="width:60px;">
    <span>:</span>
    <input type="number" min="0" max="59" class="intTimeM" style="width:60px;">
    <span>:</span>
    <input type="number" min="0" max="59" class="intTimeS" style="width:60px;">
  </div>
</label><br>
    <label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: <input type="text" class="intComment" placeholder="–ü—É–ª—å—Å/–∑–∞–º–µ—Ç–∫–∞"></label><br>
    <button class="btn secondary" type="button" onclick="clearIntervalFields(this)">–û—á–∏—Å—Ç–∏—Ç—å</button>
    <button class="btn secondary" type="button" onclick="removeInterval(this)">–£–¥–∞–ª–∏—Ç—å</button>
  `;
  container.appendChild(block);
  renumberIntervals(); // üîë –ø–µ—Ä–µ—Å—á—ë—Ç —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
}

    
function removeInterval(btn) {
  btn.parentElement.remove();
  renumberIntervals();
}

function clearIntervalFields(btn) {
  const block = btn.parentElement;
  block.querySelector('.intDistance').value = "";
  block.querySelector('.intPaceM').value = "";
  block.querySelector('.intPaceS').value = "";
  block.querySelector('.intTime').value = "";
  block.querySelector('.intComment').value = "";
}

function renumberIntervals() {
  const blocks = document.querySelectorAll('#intervalList .card h4');
  blocks.forEach((h4, i) => {
    h4.textContent = `–ò–Ω—Ç–µ—Ä–≤–∞–ª ${i+1}`;
  });
}
    
function calcIntervals() {
  const distances = document.querySelectorAll('.intDistance');
  const paceMinutes = document.querySelectorAll('.intPaceM');
  const paceSeconds = document.querySelectorAll('.intPaceS');
  const times = document.querySelectorAll('.intTime');
  const comments = document.querySelectorAll('.intComment');

  let table = "<table border='1' style='width:100%;border-collapse:collapse;text-align:center;'><tr><th>–ò–Ω—Ç–µ—Ä–≤–∞–ª</th><th>–î–∏—Å—Ç–∞–Ω—Ü–∏—è (–∫–º)</th><th>–¢–µ–º–ø</th><th>–í—Ä–µ–º—è</th><th>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th></tr>";

  for (let i = 0; i < distances.length; i++) {
    // —á–∏—Ç–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è
  const dist = parseFloat(distances[i].value) || 0;
  const pm = parseInt(paceMinutes[i].value) || 0;
  const ps = parseInt(paceSeconds[i].value) || 0;
  const h = parseInt(document.querySelectorAll('.intTimeH')[i].value) || 0;
const m = parseInt(document.querySelectorAll('.intTimeM')[i].value) || 0;
const s = parseInt(document.querySelectorAll('.intTimeS')[i].value) || 0;
const totalMinutes = h * 60 + m + (s / 60);
  const comment = comments[i].value;

    // –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ç–µ–º–ø –≤ –º–∏–Ω—É—Ç—ã/–∫–º
  let paceMinPerKm = null;
  let paceOut = "";
  if (pm > 0 || ps > 0) {
    paceMinPerKm = pm + (ps/60);
    paceOut = `${pm}:${ps.toString().padStart(2,"0")}`;
  }


    let distOut = dist;
    let timeOut = totalMinutes;

    // –≤—ã—á–∏—Å–ª—è–µ–º –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä
    if (dist && totalMinutes && !paceMinPerKm) {
      const rawPace = totalMinutes / dist;
      paceOut = formatPace(rawPace);
    }
    else if (dist && paceMinPerKm && !totalMinutes) {
      const total = dist * paceMinPerKm;
      timeOut = total.toFixed(1);
    }
    else if (totalMinutes && paceMinPerKm && !dist) {
      const distCalc = totalMinutes / paceMinPerKm;
      distOut = distCalc.toFixed(2);
    }

    // –µ—Å–ª–∏ –≤–æ–æ–±—â–µ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö ‚Äî –ø—Ä–æ–ø—É—Å–∫–∞–µ–º —Å—Ç—Ä–æ–∫—É
    if (!(distOut || paceOut || timeOut)) continue;

    table += `<tr>
      <td>${i+1}</td>
      <td>${distOut ?? ""}</td>
      <td>${paceOut ?? ""}</td>
      <td>${timeOut ?? ""}</td>
      <td>${comment}</td>
    </tr>`;
  }

  table += "</table>";
  document.getElementById('intervalResult').innerHTML = table;
}


function clearAllIntervals() {
  document.querySelectorAll('.intDistance').forEach(el => el.value = "");
  document.querySelectorAll('.intPaceM').forEach(el => el.value = "");
  document.querySelectorAll('.intPaceS').forEach(el => el.value = "");
  document.querySelectorAll('.intTime').forEach(el => el.value = "");
  document.querySelectorAll('.intComment').forEach(el => el.value = "");
  document.getElementById('intervalResult').innerHTML = "";
}

function clearIntervals() {
  document.getElementById('intervalList').innerHTML = "";
  document.getElementById('intervalResult').innerHTML = "";
  intervalCount = 0;
}
    
function formatPace(minutesPerKm) {
  if (!isFinite(minutesPerKm)) return "";
  let paceMin = Math.floor(minutesPerKm);
  let paceSec = Math.round((minutesPerKm - paceMin) * 60);
  if (paceSec === 60) { paceMin += 1; paceSec = 0; }
  return `${paceMin}:${paceSec.toString().padStart(2, '0')} –º–∏–Ω/–∫–º`;
}

function formatHMS(totalMinutes) {
  if (!isFinite(totalMinutes)) return "";
  const totalSeconds = Math.round(totalMinutes * 60);
  const h = Math.floor(totalSeconds / 3600);
  const m = Math.floor((totalSeconds % 3600) / 60);
  const s = totalSeconds % 60;

  let parts = [];
  if (h > 0) parts.push(`${h} —á`);
  if (m > 0) parts.push(`${m} –º–∏–Ω`);
  parts.push(`${s} —Å–µ–∫`);

  return parts.join(" ");
}

function calcRun() {
  const d = parseFloat(document.getElementById('runDistance').value);
  const timeMin = toMinutes(
    document.getElementById('runTimeH').value,
    document.getElementById('runTimeM').value,
    document.getElementById('runTimeS').value
  );

  const pm = parseInt(document.getElementById('runPaceM').value) || 0;
  const ps = parseInt(document.getElementById('runPaceS').value) || 0;
  let paceMinPerKm = (pm > 0 || ps > 0) ? pm + ps / 60 : null;

  let filled = {
    distance: isFinite(d) && d > 0,
    totalMinutes: isFinite(timeMin) && timeMin > 0,
    pace: isFinite(paceMinPerKm) && paceMinPerKm > 0
  };

  let out = "";

  if (filled.distance && filled.totalMinutes && !filled.pace) {
    const rawPace = timeMin / d;
    out = `–¢–µ–º–ø: ${formatPace(rawPace)}`;
  }
  else if (filled.distance && filled.pace && !filled.totalMinutes) {
    const total = d * paceMinPerKm;
    out = `–í—Ä–µ–º—è: ${formatHMS(total)}`;
  }
  else if (filled.totalMinutes && filled.pace && !filled.distance) {
    const dist = timeMin / paceMinPerKm;
    out = `–î–∏—Å—Ç–∞–Ω—Ü–∏—è: ${dist.toFixed(2)} –∫–º`;
  }
  else {
    out = "–ó–∞–ø–æ–ª–Ω–∏ –¥–≤–∞ –±–ª–æ–∫–∞ –∏–∑ —Ç—Ä—ë—Ö (–¥–∏—Å—Ç–∞–Ω—Ü–∏—è/—Ç–µ–º–ø/–≤—Ä–µ–º—è), —á—Ç–æ–±—ã –ø–æ—Å—á–∏—Ç–∞—Ç—å —Ç—Ä–µ—Ç–∏–π.";
  }

  document.getElementById('runResult').textContent = out;
}


function clearRun() {
  ['runDistance','runPaceM','runPaceS','runTimeH','runTimeM','runTimeS'].forEach(id => {
    document.getElementById(id).value = '';
  });
  document.getElementById('runResult').textContent = '';
}

  </script>
</body>
</html>
